<!doctype html>
<html lang="en">
<body>
    <pre class="mermaid">
        erDiagram
            order_status {
                uint id PK
                string ref UK "enum for use in codebase"
                string name "translation slug or human readable status"
            }

            country {
                uint id PK
                string(2) iso_code UK
            }

            supplier {
                uuid id PK
                string name UK
                datetime created_at
                datetime updated_at
            }

            product {
                uuid id PK
                uuid supplier_id FK
                string name
                decimal price
                uint stock_count
                datetime created_at
                datetime updated_at
            }
            product }o--|| supplier : has
            product ||..o{ order_line : "when ordered"

            order_line {
                uuid id PK
                uuid order_id FK
                uuid product_id FK
                uint quantity
                decimal net_price
                decimal vat
                datetime created_at
            }
            order ||--o{ order_line : "is part of"

            order {
                uuid id PK
                uint status_id FK
                uuid shipping_address_id FK "nullable"
                datetime created_at
                datetime updated_at
            }
            order }o..|| order_status : has
            order }o..|| address : "will ship to"

            completed_order {
                uuid order_id PK
                decimal net_price
                decimal vat
                decimal gross_price
                string shipping_line_1
                string shipping_line_2 "nullable"
                string shipping_city
                string shipping_postcode "nullable"
                uint shipping_country FK
                datetime created_at
                datetime shipped_at
                datetime delivered_at
                datetime updated_at
            }
            completed_order |o--|| order : "when completed"
            completed_order }|--|| country : "ships to"

            address {
                uuid id PK
                string line_1
                string line_2 "nullable"
                string city
                string postcode "nullable"
                uint country
            }
            address }|--|| country : "is in"
    </pre>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>
</html>